<tal:title define="global title python: doc_helper.unpack_name_string(catalogue) + ' - ' + roster.str_grf_name" />
<tal:suppress_hero_unit define="global suppress_hero_unit True" />

<!--! this page uses a catalogue as main context, and an example_model_variant is also in scope as needed -->

<tal:main_template define="main_template load: main_template.pt" metal:use-macro="main_template">
<div metal:fill-slot='body'>
    <div class="hero-unit subhead" style="padding-top:20px; padding-bottom:20px;">
        <div class="container text-left">
            <div class="row">
                <div class="span10 offset1">
                    <h1 style="font-size:48px; padding-top:0;">${roster.str_grf_name}</h1>
                    <p class="lead">My Lovely <strike>Horse</strike> Train Set</p>
                </div>
            </div>
        </div>
    </div>
    <div class="container text-left">
        <div class="row">
            <div class="span10 offset1">
                <h2>
                    ${doc_helper.unpack_name_string(catalogue)}
                    ${'(' + doc_helper.lang_strings[example_model_variant.str_name_suffix] + ')' if example_model_variant.str_name_suffix is not None else None}
                    <small>Vehicle Info</small>
                </h2>
                <div style="margin-top:30px; margin-bottom:50px;">
                    <tal:catalogue_entries repeat="catalogue_entry catalogue">
                        <tal:cc_recolour repeat="cc_remap_pair catalogue_entry.livery_def.docs_image_input_cc">
                            <div class="vehicle-image"
                                style="width:${2 * doc_helper.docs_sprite_max_width};
                                       display:inline-block;">
                                <img src="static/img/${catalogue_entry.model_variant_id}_${doc_helper.get_livery_file_substr(cc_remap_pair)}.png"
                                     width="${2 * doc_helper.docs_sprite_width(catalogue=catalogue)}"
                                     height="${2 * doc_helper.docs_sprite_height}" />
                            </div>
                        </tal:cc_recolour>
                    </tal:catalogue_entries>
                    <br />
                    <tal:catalogue_entries repeat="catalogue_entry catalogue">
                        <tal:cc_recolour repeat="cc_remap_pair catalogue_entry.livery_def.docs_image_input_cc">
                            <div class="vehicle-image"
                                style="width:${4 * doc_helper.docs_sprite_max_width};
                                       display:inline-block;">
                                <img src="static/img/${catalogue_entry.model_variant_id}_${doc_helper.get_livery_file_substr(cc_remap_pair)}.png"
                                     width="${4 * doc_helper.docs_sprite_width(catalogue=catalogue)}"
                                     height="${4 * doc_helper.docs_sprite_height}" />
                            </div>
                        </tal:cc_recolour>
                    </tal:catalogue_entries>
                </div>
                <style>
                    blockquote.vehicle-quote p {
                        font-size: 24px;
                        margin-left: 20px;
                        max-width: 90%;
                    }
                    blockquote.vehicle-quote p:before {
                        content: "\201C";
                        left: 0;
                        top: 0;
                        margin-left: -20px;
                        font-size: 36px;
                        line-height: 32px;
                        font-weight: 400;
                    }
                    blockquote.vehicle-quote p:after {
                        content: "\201D";
                        right: 0;
                        bottom: 0;
                        font-size: 36px;
                        line-height: 32px;
                        font-weight: 400;
                    }
                    blockquote.vehicle-quote small {
                        font-size: 16px;
                        margin-top: 10px;
                    }
                </style>
                <blockquote class="vehicle-quote">
                    <p>
                        ${structure: catalogue.model_def.description}
                    </p>
                    <small>
                        <cite>
                            ${structure: catalogue.cite}
                        </cite>
                    </small>
                </blockquote>

                <style>
                    table.vehicle-facts {
                        background: #e0f4fc;
                        border-radius: 4px;
                        font-size: 16px;
                        width: 100%;
                        margin-bottom: 30px;
                    }
                    table.vehicle-facts th {
                        background: #b4dcec;
                        color: #18506c;
                        width: 210px; /* oof exact pixel sizing, regrettable */
                        padding: 16px;
                        text-align: right;
                        border-bottom: solid 1px #b4dcec;
                    }
                    table.vehicle-facts tr:first-of-type th {
                        padding-top: 21px;
                        border-top-left-radius: 4px;
                    }
                    table.vehicle-facts tr:first-of-type td {
                        padding-top: 21px;
                    }
                    table.vehicle-facts tr:last-of-type th {
                        padding-bottom: 21px;
                        border-bottom-left-radius: 4px;
                        border-bottom: none;
                    }
                    table.vehicle-facts td {
                        margin: 0;
                        padding: 16px;
                        border-bottom: solid 1px #b4dcec;
                    }
                    table.vehicle-facts tr:last-of-type td {
                        border-bottom: none;
                    }
                </style>

                <table class="vehicle-facts">
                    <tbody>
                        <tr>
                            <th>Role</th>
                            <td>${doc_helper.get_role_string_from_catalogue(catalogue, iron_horse.badge_manager)}</td>
                        </tr>
                        <tr>
                            <th>Intro year / Designed</th>
                            <td>${catalogue.intro_year}</td>
                        </tr>
                        <tr>
                            <th>Max. Speed</th>
                            <td>${doc_helper.speed_formatted_for_docs(catalogue)}</td>
                        </tr>
                        <tr>
                            <th>Power</th>
                            <td>${" / ".join(doc_helper.power_formatted_for_docs(catalogue))}</td>
                        </tr>
                        <tr>
                            <th>Weight</th>
                            <td>${example_model_variant.weight} tonnes</td>
                        </tr>
                        <tal:optional_capacity condition="doc_helper.capacity_formatted_for_docs(catalogue) is not None">
                            <tr>
                                <th>Capacity</th>
                                <td>${doc_helper.capacity_formatted_for_docs(catalogue)}</td>
                            </tr>
                        </tal:optional_capacity>
                        <tr>
                            <th>Track types</th>
                            <td>${", ".join(example_model_variant.track_types)}</td>
                        </tr>
                    </tbody>
                </table>

                <h3 id="appearance">Appearance</h3>
                <div style="font-size:16px;">
                    <p>This vehicle has ${len(catalogue)} ${"livery" if len(catalogue) == 1 else "liveries"}.</p>
                </div>

                <style>
                    table.livery-or-trailers-table {
                        width: 100%;
                        background-color: #eee;
                        border-color: solid 1px #80c4fc;
                        border-radius: 4px;
                        background: #e0f4fc;
                        color: black;
                        font-size: 16px;
                        margin-bottom: 30px;
                    }
                    table.livery-or-trailers-table tr {
                        vertical-align: top;
                    }
                    table.livery-or-trailers-table td, table.livery-or-trailers-table th {
                        margin: 0;
                        padding: 16px;
                        border-bottom: solid 1px #b4dcec;
                    }
                    table.livery-or-trailers-table tr:last-of-type td, table.livery-or-trailers-table tr:last-of-type th {
                        border-bottom: none;
                    }
                    table.livery-or-trailers-table .livery-or-trailers-table-first-col {
                        min-width: 215px;
                        width: 215px;
                        background: #b4dcec;
                        text-align: right;
                        background: #b4dcec;
                        color: #18506c;
                    }
                    table.livery-or-trailers-table thead tr:first-of-type th.livery-or-trailers-table-first-col {
                        border-top-left-radius: 4px;
                    }
                    table.livery-or-trailers-table tbody tr:last-of-type th.livery-or-trailers-table-first-col {
                        border-bottom-left-radius: 4px;
                    }
                    table.livery-or-trailers-table td.livery-or-trailers-table-col-with-divider, table.livery-or-trailers-table th.livery-or-trailers-table-col-with-divider {
                        border-left: solid 1px #b4dcec;
                    }
                    table.livery-or-trailers-table .livery-example-container {
                        display: inline-block;
                         width: 128px;
                    }
                </style>

                <table class="livery-or-trailers-table text-left">
                    <tal:catalogue_entries repeat="catalogue_entry catalogue">
                        <tr>
                            <th class="livery-or-trailers-table-first-col"><div style="margin-top:12px;">Livery ${repeat.catalogue_entry.number} examples</div></th>
                            <td class="livery-or-trailers-table-col-with-divider">
                                <tal:cc_recolour repeat="cc_remap_pair catalogue_entry.livery_def.docs_image_input_cc">
                                    <div class="livery-example-container">
                                        <div class="vehicle-image"
                                            style="width:${3 * doc_helper.docs_sprite_max_width}; vertical-align:top; margin-top:-8px; margin-bottom:10px;">
                                            <img src="static/img/${catalogue_entry.model_variant_id}_${doc_helper.get_livery_file_substr(cc_remap_pair)}.png"
                                                 width="${3 * doc_helper.docs_sprite_width(catalogue=catalogue)}"
                                                 height="${3 * doc_helper.docs_sprite_height}" />
                                        </div>
                                        <div style="display:block;">
                                            <tal:colours repeat="company_colour cc_remap_pair">
                                                <!--! !! probably should be a caption for a figure ?? -->
                                                <span style="background:linear-gradient(-45deg, rgb${doc_helper.get_company_colour_as_rgb(company_colour, offset=3)}, rgb${doc_helper.get_company_colour_as_rgb(company_colour, offset=7)});
                                                             display:inline-block;
                                                             vertical-align:middle;
                                                             border:solid 1px #555;
                                                             width:12px;
                                                             height:12px;">
                                                </span>
                                                <span style="vertical-align:middle; font-size:13px;">${doc_helper.company_colour_names[company_colour]}</span>
                                                <br />
                                            </tal:colours>
                                        </div>
                                    </div>
                                </tal:cc_recolour>
                            </td>
                        </tr>
                    </tal:catalogue_entries>
                </table>

                <tal:has_dedicated_trailers condition="len(catalogue.dedicated_trailer_catalogue_model_variant_mappings) > 0">
                    <h3>Dedicated Trailers / Coaches / Mail Vans</h3>
                    <table class="livery-or-trailers-table text-left">
                        <tal:trailer_catalogue_model_variant_mappings repeat="trailer_catalogue_model_variant_mapping catalogue.dedicated_trailer_catalogue_model_variant_mappings">
                            <tr>
                                <th class="livery-or-trailers-table-first-col">
                                    <div style="margin-top:12px;">${doc_helper.unpack_name_string(trailer_catalogue_model_variant_mapping['catalogue'])}</div>
                                </th>
                                <td class="livery-or-trailers-table-col-with-divider">
                                    <tal:trailer_model_variants repeat="trailer_model_variant trailer_catalogue_model_variant_mapping['model_variants']">
                                        <div>
                                            <tal:livery_examples repeat="cc_remap_pair trailer_model_variant.catalogue_entry.livery_def.docs_image_input_cc">
                                                <div class="vehicle-image"
                                                    style="width:${2 * doc_helper.docs_sprite_max_width};
                                                           display:inline-block;">
                                                    <img src="static/img/${trailer_model_variant.id}_${doc_helper.get_livery_file_substr(cc_remap_pair)}.png"
                                                         width="${2 * doc_helper.docs_sprite_width(catalogue=trailer_catalogue_model_variant_mapping['catalogue'])}"
                                                         height="${2 * doc_helper.docs_sprite_height}" />
                                                </div>
                                            </tal:livery_examples>
                                        </div>
                                    </tal:trailer_model_variants>
                                </td>
                            </tr>
                        </tal:trailer_catalogue_model_variant_mappings>
                    </table>
                </tal:has_dedicated_trailers>

                <h3 id="foamer-facts">Foamer Facts</h3>
                <p>Inspired by ${structure: catalogue.model_def.foamer_facts}.</p>

                <hr />
                <h3 id="tech-tree">Tech Tree</h3>
                <table class="vehicle-facts">
                    <tbody>
                        <tr>
                            <th style="text-align:center;">Previous</th>
                            <th style="text-align:center;">This Vehicle</th>
                            <th style="text-align:center;">Replaced by</th>
                        </tr>
                        <tr>
                            <td style="text-align:center; vertical-align:middle;">
                                <!--! replaces -->
                                <tal:previous_gen condition="len(catalogue.previous_gen_catalogues) > 0">
                                    <tal:previous_gen_catalogue repeat="previous_gen_catalogue catalogue.previous_gen_catalogues">
                                        <div style="margin:10px;">
                                            <a href="${previous_gen_catalogue.model_id}.html">
                                                <div class="vehicle-image" style="margin-bottom:7px;">
                                                    <img src="static/img/${previous_gen_catalogue.example_model_variant.catalogue_entry.model_variant_id}_red_white.png"
                                                         width="${2 * doc_helper.docs_sprite_width(catalogue=previous_gen_catalogue)}"
                                                         height="${2 * doc_helper.docs_sprite_height}" />
                                                </div>
                                                 ${doc_helper.unpack_name_string(previous_gen_catalogue)}
                                            </a>
                                        </div>
                                     </tal:previous_gen_catalogue>
                                </tal:previous_gen>
                                <tal:no_previous_gen condition="len(catalogue.previous_gen_catalogues) == 0">
                                    <span class="muted">None</span>
                                </tal:no_previous_gen>
                            </td>
                            <!--! this vehicle -->
                            <td style="text-align:center; vertical-align:middle;">
                                <div class="vehicle-image" style="margin-bottom:15px;">
                                    <img src="static/img/${example_model_variant.catalogue_entry.model_variant_id}_red_white.png"
                                         width="${4 * doc_helper.docs_sprite_width(catalogue=catalogue)}"
                                         height="${4 * doc_helper.docs_sprite_height}" />
                                </div>
                                <p>${doc_helper.unpack_name_string(catalogue)}</p>

                                <p><a href="tech_tree_table_red.html#${catalogue.model_id}">See in Tech Tree</a></p>
                            </td>
                            <!--! replaced by -->
                            <td style="text-align:center; vertical-align:middle;">
                                <tal:next_gen condition="catalogue.next_gen_catalogue is not None">
                                    <div style="margin:10px;">
                                        <a href="${catalogue.next_gen_catalogue.model_id}.html">
                                            <div class="vehicle-image" style="margin-bottom:7px;">
                                                <img src="static/img/${catalogue.next_gen_catalogue.example_model_variant.catalogue_entry.model_variant_id}_red_white.png"
                                                     width="${2* doc_helper.docs_sprite_width(catalogue=catalogue.next_gen_catalogue)}"
                                                     height="${2 * doc_helper.docs_sprite_height}" />
                                            </div>
                                             <p>${doc_helper.unpack_name_string(catalogue.next_gen_catalogue)}</p>
                                        </a>
                                    </div>
                                </tal:next_gen>
                                <tal:no_next_gen condition="catalogue.next_gen_catalogue is None">
                                    <span class="muted">None</span>
                                </tal:no_next_gen>
                            </td>
                        </tr>
                        <tr>
                            <th colspan="3" style="text-align:center">See also&hellip;</th>
                        </tr>
                        <tr>
                            <td colspan="3" style="text-align:center">
                                <!--! this really isn't a well constructed table, but eh -->
                                <tal:similar_model_catalogues repeat="similar_model_catalogue catalogue.similar_model_catalogues">
                                    <div style="display:inline-block; margin:10px;">
                                        <a href="${similar_model_catalogue.model_id}.html">
                                            <div class="vehicle-image" style="margin-bottom:7px;">
                                                <img src="static/img/${similar_model_catalogue.example_model_variant.catalogue_entry.model_variant_id}_red_white.png"
                                                     width="${2* doc_helper.docs_sprite_width(catalogue=similar_model_catalogue)}"
                                                     height="${2 * doc_helper.docs_sprite_height}" />
                                            </div>
                                             ${doc_helper.unpack_name_string(similar_model_catalogue)}
                                        </a>
                                    </div>
                                </tal:similar_model_catalogues>
                                <tal:no_no_similar_model_catalogues condition="len(catalogue.similar_model_catalogues) == 0">
                                    <span class="muted">Sorry, nothing else to show here :|</span>
                                </tal:no_no_similar_model_catalogues>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
</tal:main_template>
